{% extends "base.html" %}
{% load static %}

{% block content %}
    <main class="max-w-4xl mx-auto px-6 py-8">
    <div class="flex items-center justify-between mb-6">
        <a href="{% url 'home' %}" class="text-slate-600 hover:text-slate-800">Continue Shopping</a>
        <h1 class="serif text-3xl font-semibold text-center">Your Cart</h1>
        <div></div>
    </div>

    <div class="bg-slate-100 rounded-lg p-4 mb-6">
        <p class="text-center text-slate-700">Free & Fast arriving in 1day Order within 23 hours, 53 minutes, 50 seconds</p>
    </div>

    {% if cart_items %}
        <div class="border-t border-slate-200 pt-6">
        {% for item in cart_items %}
            <div class="flex items-center gap-6 mb-6">
            <div class="h-24 w-24 rounded-lg bg-slate-100 flex items-center justify-center">
                <img src="{{ item.product.image_url.url }}" alt="{{ item.product.name }}" class="h-20 object-contain"/>
            </div>
            <div class="flex-1">
                <h3 class="font-semibold">{{ item.product.brand }}</h3>
                <p class="text-slate-700">{{ item.product.name }}</p>
                <p class="text-slate-600">MRP ₹ {{ item.product.price_mrp }}</p>
                <div class="flex items-center gap-4 mt-2">
                <!-- Quantity Update Form -->
                <form method="post" action="{% url 'update_cart_quantity' item.id %}">
                    {% csrf_token %}
                    <select name="quantity" class="border rounded px-2 py-1 text-sm" onchange="this.form.submit()">
                    <option value="0" {% if item.quantity == 0 %}selected{% endif %}>Remove</option>
                    <option value="1" {% if item.quantity == 1 %}selected{% endif %}>1</option>
                    <option value="2" {% if item.quantity == 2 %}selected{% endif %}>2</option>
                    <option value="3" {% if item.quantity == 3 %}selected{% endif %}>3</option>
                    <option value="4" {% if item.quantity == 4 %}selected{% endif %}>4</option>
                    <option value="5" {% if item.quantity == 5 %}selected{% endif %}>5</option>
                    <option value="6" {% if item.quantity == 6 %}selected{% endif %}>6</option>
                    <option value="7" {% if item.quantity == 7 %}selected{% endif %}>7</option>
                    <option value="8" {% if item.quantity == 8 %}selected{% endif %}>8</option>
                    <option value="9" {% if item.quantity == 9 %}selected{% endif %}>9</option>
                    <option value="10" {% if item.quantity == 10 %}selected{% endif %}>10</option>
                    </select>
                </form>

                <!-- Optional Remove Link -->
                <a href="{% url 'remove_from_cart' item.id %}" class="text-red-600 hover:text-red-800 flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="h-4 w-4" viewBox="0 0 24 24">
                    <path fill-rule="evenodd" d="M16.5 4.478v.227a48.816 48.816 0 0 1 3.878.512.75.75 0 1 1-.256 1.478l-.209-.035-1.005 13.07a3 3 0 0 1-2.991 2.77H8.084a3 3 0 0 1-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 0 1-.256-1.478A48.567 48.567 0 0 1 7.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 0 1 3.369 0c1.603.051 2.815 1.387 2.815 2.951Zm-6.136-1.452a51.196 51.196 0 0 1 3.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 0 0-6 0v-.113c0-.794.609-1.428 1.364-1.452ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75ZM12 15a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"/>
                    </svg>
                    Remove
                </a>
                </div>
            </div>
            </div>
        {% endfor %}
        </div>

        <div class="border-t border-slate-200 pt-6">
        <h2 class="font-semibold mb-4">Summary</h2>
        <div class="flex justify-between items-center mb-2">
            <span>Total</span>
            <span class="font-semibold">₹ {{ total }}</span>
        </div>
        <div class="flex justify-between items-center mb-4">
            <span>Delivery</span>
            <span class="text-green-600">Free</span>
        </div>
        <div class="text-right mb-6">
            <a href="#" class="text-slate-600 text-sm hover:text-slate-800 flex items-center justify-end gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-4 w-4">
                <path d="M3.478 2.404a.75.75 0 0 0-.926.941l.58 4.13a1.5 1.5 0 0 0 1.42 1.26h9.75a1.5 1.5 0 0 0 1.42-1.26l.58-4.13a.75.75 0 0 0-.926-.94 48.07 48.07 0 0 0-12.404 0ZM2.25 15a.75.75 0 0 1 .75-.75h18a.75.75 0 0 1 0 1.5H3a.75.75 0 0 1-.75-.75Zm6.75-3a.75.75 0 0 0 0 1.5h4.5a.75.75 0 0 0 0-1.5H9Z"/>
            </svg>
            Delivery & return information
            </a>
        </div>

        <a href="{% url 'checkout_from_cart' %}" class="w-full bg-teal-800 text-white py-4 rounded-lg font-semibold text-lg mb-6 flex items-center justify-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
                <path fill-rule="evenodd" d="M12 1.5a5.25 5.25 0 0 0-5.25 5.25v3a3 3 0 0 0-3 3v6.75a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3v-6.75a3 3 0 0 0-3-3v-3c0-2.9-2.35-5.25-5.25-5.25Zm3.75 8.25v-3a3.75 3.75 0 1 0-7.5 0v3h7.5Z" clip-rule="evenodd"/>
            </svg>
            Checkout Securely
        </a>

        <div class="text-center">
            <h3 class="font-semibold mb-4">Express Checkout</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
            <button class="border border-slate-300 rounded-lg p-3 hover:bg-slate-50">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/GPay_logo.svg/200px-GPay_logo.svg.png" alt="Google Pay" class="h-6 mx-auto"/>
            </button>
            <button class="border border-slate-300 rounded-lg p-3 hover:bg-slate-50">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/PayPal.svg/200px-PayPal.svg.png" alt="PayPal" class="h-6 mx-auto"/>
            </button>
            <button class="border border-slate-300 rounded-lg p-3 hover:bg-slate-50">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Visa_Logo.png/200px-Visa_Logo.png" alt="Visa" class="h-6 mx-auto"/>
            </button>
            <button class="border border-slate-300 rounded-lg p-3 hover:bg-slate-50">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Mastercard-logo.png/200px-Mastercard-logo.png" alt="Mastercard" class="h-6 mx-auto"/>
            </button>
            </div>
        </div>
        </div>

    {% else %}
        <div class="text-center py-20 text-slate-600">
        <p>Your cart is empty.</p>
        <a href="{% url 'home' %}" class="text-teal-800 underline">Start shopping</a>
        </div>
    {% endif %}
    </main>

{% endblock %}
